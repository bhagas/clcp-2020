<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="shortcut icon" href="/images/template/Logo Kab Pekalongan.ico">
	<title>Sistem Informasi RTRW Kabupaten Pekalongan</title>

	<link href="/stylesheets/template/css/theme.css" rel="stylesheet">
	<link href="/stylesheets/template/css/style.css" rel="stylesheet">
	<link href="/stylesheets/template/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
        <style type="text/css">
       		/*body{
                font-family: "Source Sans Pro";
            }
        	.section-one ul.list-unstyled li{
        		margin-top: 10px;
        		margin-bottom: 10px;
        	}


        	.section-one ul.list-unstyled li a{
        		text-decoration: none;
        		color: black;
        		font-weight: 700;
        	}  

            .section-one .table-striped>tbody>tr:nth-child(odd)>td, 
            .section-one .table-striped>tbody>tr:nth-child(odd)>th { 
                background-color: #ffca4f; 
                color:black; 
             } 
            
            .section-one .table-striped tr { 
                background-color:#f9941c; 
                color:black; 
            } 
            
            .section-one .table-hover tbody tr:hover td, .table-hover tbody tr:hover th {
                background-color: #E0E0E0;
                color: black;
            }

        	#konten:before{
        		content: "";
        		width: 210px;
        		height: 100%;
        		background-color: #f9941c;
        		position: absolute;
        		left: -210px;
        		bottom: 0;
        		z-index: -1;
        	}*/

            body{
                  font-family: "Source Sans Pro";
              }

              .section-one ul.list-unstyled li{
                  margin-top: 10px;
                  margin-bottom: 10px;
              }


              .section-one ul.list-unstyled li a{
                  text-decoration: none;
                  color: black;
                  font-weight: 700;
              }


              .section-one a:hover .content-one{
                background-color: #e0e0e0;
                border-right: 4px solid #ccc;
                border-bottom: 4px solid #ccc;
                border-radius: 4px;
              }

              .section-one a:hover .content-one-one{
                background-color: #39C99C;
                border-radius: 4px;
              }
        </style>
    </head>

    <body>
        <section class="section-one">
            <div class="container-fluid">
              <div class="row">
                <div class="col-md-2 col-lg-2 p-l-0 p-r-0">
                  <div style="width: 100%;min-height: 100vh;background-color: #159B75;">
                    <div style="width: 100%;max-height: 100vh;background-color: #159B75;overflow-y: auto;overflow-x: hidden;">
                      <div class="row">
                        <div class="col-md-12 col-lg-12">
                          <div style="width: 100%;background-color: #39C99C;padding:  10px;border-bottom: 6px solid rgba(0,0,0,0.2);">
                            <center><img src="/images/template/Logo Kab Pekalongan.png" style="height: 80px;"></center>
                            <h5 class="m-b-0 text-center"><strong>PEMERINTAH KABUPATEN PEKALONGAN</strong></h5>
                            <h6 class="m-t-5 m-b-0 text-center"><strong>SISTEM INFORMASI RTRW <br/>KABUPATEN PEKALONGAN</strong></h6>
                          </div>
                        </div>
                      </div>

                      <div class="row p-l-15 p-r-15">
                        <div class="col-md-12 col-lg-12 m-t-10">
                          <ul class="list-unstyled">
                            <li><a href="/">HOME</a></li>
                            <li>
                                <a href="#" data-toggle="collapse" data-target="#profil" aria-expanded="false" aria-controls="collapseExample">PROFIL <i class="fa fa-angle-down" aria-hidden="true"></i></a>
                                <div class="collapse" id="profil">
                                  <ul class="list-unstyled" style="margin-left: 15px;">
                                      <li><a href="/profil/profil_kecamatan">PROFIL KECAMATAN</a></li>
                                      <li><a href="/profil/profil_desa">PROFIL DESA</a></li>
                                      <li><a href="/profil/profil_jenis_tanah">PROFIL JENIS TANAH</a></li>
                                      <li><a href="/profil/profil_kelerengan">PROFIL KELERENGAN</a></li>
                                      <li><a href="/profil/profil_kesesuaian_lahan">PROFIL KESESUAIAN LAHAN</a></li>
                                      <li><a href="/profil/profil_morfologi_wilayah">PROFIL MORFOLOGI WILAYAH</a></li>
                                  </ul>
                                </div>
                            </li>
                            <li><a href="/tujuan_strategi">TUJUAN & STRATEGI</a></li>
                            <li>
                                <a href="#" data-toggle="collapse" data-target="#strukturruang" aria-expanded="false" aria-controls="collapseExample">STRUKTUR RUANG <i class="fa fa-angle-down" aria-hidden="true"></i></a>
                                <div class="collapse" id="strukturruang">
                                  <ul class="list-unstyled" style="margin-left: 15px;">
                                      <li><a href="/struktur_ruang/sistem_pusat_kegiatan">SISTEM PUSAT KEGIATAN</a></li>
                                      <li><a href="/struktur_ruang/sistem_jaringan_prasarana">SISTEM JARINGAN PRASARANA</a></li>
                                  </ul>
                                </div>
                            </li>
                            <li><a href="/pola_ruang">POLA RUANG</a></li>
                            <li><a href="/kawasan_strategis">KAWASAN STRATEGIS</a></li>
                            <li><a href="/arahan_pengendalian">ARAHAN PENGENDALIAN</a></li>
                            <li><a href="/indikasi_program">INDIKASI PROGRAM</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-md-10 col-lg-10" style="position: relative;">
                  <div class="row">
                    <div class="col-md-12 col-lg-12">
                        <h4 class="m-t-0"><strong>DETAIL LUAS WILAYAH "KECAMATANNYA" Total luas :<div id="luas_kecamatan"></div></strong></h4>
                        <hr/ class="m-t-0 m-b-10">
                    </div>
                  </div>

                  <div class="row m-b-15">
                    <div class="col-md-7 col-lg-7">
                        <div class="row">
                            <div class="col-md-12 col-lg-12">
                                <div style="width: 100%;height: 500px;" id="chartContainer2"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-5 col-lg-5">
                        <table class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th style="background-color: #E0E0E0">No.</th>
                                    <th style="background-color: #E0E0E0">Pola Ruang</th>
                                    <th style="background-color: #E0E0E0">Luas (Ha)</th>
                                </tr>
                            </thead>

                            <tbody id="tabel_polaruang">
                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td>1.</td>
                                    <td>-</td>
                                    <td class="text-right">0000</td>
                                </tr>

                                <tr>
                                    <td colspan="2">Total</td>
                                    <td class="text-right">0000</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </section>

    	<script src="/plugins/jquery/jquery-1.11.1.min.js"></script>
    	<script src="/javascripts/template/bootstrap.min.js"></script>
    	<script src="/plugins/canvasjs/canvasjs.min.js"></script>
       <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
       <script src="https://unpkg.com/esri-leaflet@2.1.1/dist/esri-leaflet.js"
          integrity="sha512-ECQqaYZke9cSdqlFG08zSkudgrdF6I1d8ViSa7I3VIszJyVqw4ng1G8sehEXlumdMnFYfzY0tMgdQa4WCs9IUw=="
          crossorigin=""></script>
       <script src="/resources-maps/javascripts/leaflet-routing-machine.js"></script>

       <script src="/javascripts/template/bootstrap.min.js"></script>
       <script src="/plugins/canvasjs/canvasjs.min.js"></script>
       <script src="/plugins/bxslider/jquery.bxslider.min.js"></script>
       <script src="/plugins/rev_slider_plugins/js/jquery.themepunch.plugins.min.js"></script>
       <script src="/plugins/rev_slider_plugins/js/jquery.themepunch.revolution.min.js"></script>
       <script src="/resources-maps/javascripts/leaflet.label.js"></script>
       <script src="/resources-maps/panah-asmara.js"></script>
       <script src="https://maps.google.com/maps/api/js?v=3.2&key=AIzaSyBy8irzccEOp7ezf5nQ2UPaLGcte_AEsOQ"></script>
       <script src='https://unpkg.com/leaflet.gridlayer.googlemutant@latest/Leaflet.GoogleMutant.js'></script>
       <script src="/resources-maps/javascripts/L.Control.Locate.js" ></script>
       <script src="/resources-maps/javascripts/leaflet-routing-machine.js"></script>
       <script src="/resources-maps/javascripts/leaflet.extra-markers.js"></script>
       <script src="/resources-maps/javascripts/leaflet-image.js"></script>
       <script src="https://d3js.org/topojson.v1.min.js"></script>
       <script src="/resources-maps/javascripts/Control.FullScreen.js"></script>
       <script src="/resources-maps/javascripts/groupedlayercontrol.js"></script>
       <script src="/resources-maps/javascripts/wicket.js"></script>
       <script src="/resources-maps/javascripts/wicket-leaflet.js"></script>
       <!-- drawing -->
       <script src="/resources-maps/draw/Leaflet.draw.js"></script>
       <script src="/resources-maps/draw/Leaflet.Draw.Event.js"></script>
       <script src="/resources-maps/draw/Toolbar.js"></script>
       <script src="/resources-maps/draw/Tooltip.js"></script>
       <script src="/resources-maps/draw/ext/GeometryUtil.js"></script>
       <script src="/resources-maps/draw/ext/LatLngUtil.js"></script>
       <script src="/resources-maps/draw/ext/LineUtil.Intersect.js"></script>
       <script src="/resources-maps/draw/ext/Polygon.Intersect.js"></script>
       <script src="/resources-maps/draw/ext/Polyline.Intersect.js"></script>
       <script src="/resources-maps/draw/ext/TouchEvents.js"></script>
       <script src="/resources-maps/draw/draw/DrawToolbar.js"></script>
       <script src="/resources-maps/draw/draw/handler/Draw.Feature.js"></script>
       <script src="/resources-maps/draw/draw/handler/Draw.SimpleShape.js"></script>
       <script src="/resources-maps/draw/draw/handler/Draw.Polyline.js"></script>
       <script src="/resources-maps/draw/draw/handler/Draw.Marker.js"></script>
       <script src="/resources-maps/draw/draw/handler/Draw.Polygon.js"></script>
       <script src="/resources-maps/draw/draw/handler/Draw.Rectangle.js"></script>
       <script src="/resources-maps/draw/edit/EditToolbar.js"></script>
       <script src="/resources-maps/draw/edit/handler/EditToolbar.Edit.js"></script>
       <script src="/resources-maps/draw/edit/handler/EditToolbar.Delete.js"></script>
       <script src="/resources-maps/draw/Control.Draw.js"></script>
       <script src="/resources-maps/draw/edit/handler/Edit.Poly.js"></script>
       <script src="/resources-maps/draw/edit/handler/Edit.SimpleShape.js"></script>
       <script src="/resources-maps/draw/edit/handler/Edit.Rectangle.js"></script>
       <script src="/resources-maps/draw/edit/handler/Edit.Marker.js"></script> 
       <script src="/resources-maps/main.js"></script> 
    	<!-- Plugins This Page -->
    	<!-- End Plugins This Page -->
    	<script type="text/javascript">
    		window.onload = function () {
    			

    			var grafik =[];
          var luas_kecamatan = 0;
          var html ="";
          var wkt = new Wkt.Wkt();
          var total_persen = 0;
                   $.ajax({
                                 type : "GET",
                                 async : false,
                                 global : false,
                                 url : "/peta/list_polaruang_kecamatan/<%= id_kecamatan%>",
                                 dataType : 'json',
                                 success: function (data) {
                              //  console.log(data)
                                   
                            
                                  $.each(data.admin, function(){
                                  wkt.read(''+this.geometry+'');
                                   var latlngss = wkt.toObject().getLatLngs();                         
                                    luas_kecamatan = L.GeometryUtil.geodesicArea(latlngss[0]);
                                    $('#luas_kecamatan').html(L.GeometryUtil.readableArea(luas_kecamatan, true, {}))
                                  })
                                 
                                var i = 0;
                                  $('#tabel_polaruang').empty()
                                $.each(data.pola_ruang, function(){
                                    var total = 0;
                                    if(this.irisan && this.irisan.length>0){
                                        $.each(this.irisan, function(){
                                                if(this.polygon){
                                                 
                                                 wkt.read(''+this.polygon+'');
                                                //  console.log(wkt.type)
                                                 if(wkt.type!='geometrycollection'){
                                                  var latlngss = wkt.toObject().getLatLngs();
                                                     var gambar = wkt.toObject();
                                              
                                                 //  console.log(this)
                                                 //  console.log(wkt.toObject().getLatLngs())
                                                     //hitung luas
                                                   if(wkt.toObject().getLatLngs().length > 1){
                                                     $.each(latlngss, function(index, value){
                                                      if(value.length > 1){
                                                        $.each(value, function(indexx, valuee){
                                                          var luas =  L.GeometryUtil.geodesicArea(valuee);
                                                          total = total + luas; 
                                                        })
                                                      }else{
                                                        var luas =  L.GeometryUtil.geodesicArea(value);
                                                          total = total + luas;  
                                                      }
                                                        
                                                        
                                                     })
                                                   }else{

                                                    var luas =  L.GeometryUtil.geodesicArea(latlngss[0]);
                                                    
                                                          total = total + luas;   
                                                   }
                                                }
                                              }  
                                                               
                                        })
                                      }
                                        if(total != 0){
                                          var hasil = (parseFloat(total) / parseFloat(luas_kecamatan)) * 100;
                                         // console.log(hasil)
                                         total_persen = total_persen + hasil;
                                          grafik.push({y: hasil.toFixed(2), label: this.rencana_tg})
                                           total = L.GeometryUtil.readableArea(total, true, {})

                                         }else{
                                          total = "Kesalahan dalam Penghitungan!"
                                         }
                                         i = i + 1;
                                         // html = html + "<tr><td>Kategori Pola Ruang</td><td>:</td><td>"+this.rencana_tg+" ("+total+")</td></tr>"
                                        
                                          $('#tabel_polaruang').append("<tr><td>"+i+"</td><td>"+this.rencana_tg+" </td><td>"+total+"</td></tr>")

                                         
                                        // html = html + this.rencana_tg+" ("+total+")</br>";
                                 })
                                      
                                          var sisa = 100 - total_persen;
                                           grafik.push({y: sisa.toFixed(2), label: "Lainnya"})
                                          var chart2 = new CanvasJS.Chart("chartContainer2", {
                                            animationEnabled: true,

                                            data: [{
                                              type: "pie",
                                                        // startAngle: 240,
                                                        // yValueFormatString: "##0.00\"%\"",
                                                        indexLabel: "{label} {y}",
                                                        dataPoints: grafik
                                                      }]
                                                  });

                                          chart2.render();
                                   // $("#konten-detail").toggle("slide", {direction:"right"}, 500);
                                  
                                 }
                               });
                        
    		}
    	</script>
    </body>
    </html>